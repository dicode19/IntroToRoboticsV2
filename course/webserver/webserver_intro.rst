Використання веб-сервера XRP
=======================

Вступ:
-------------

У цьому розділі ви дізнаєтеся про веб-сервери та про те, як використовувати їх для бездротового зв'язку з XRP. 
Веб-сервер — це комп'ютерна програма, яка приймає інструкції від іншого комп'ютера через Інтернет. 
Вони використовуються для відображення веб-сторінок, запуску відеоігор, надсилання повідомлень і виконання майже всіх інших дій, які можна робити в Інтернеті.
За допомогою вбудованого веб-сервера XRP ви можете бездротово відображати значення на своєму комп'ютері і навіть надсилати інструкції до XRP одним натисканням кнопки. За допомогою цієї функції ви можете легко налагоджувати програми і навіть використовувати свій телефон або комп'ютер для дистанційного керування XRP.

Написання програм, що використовують веб-сервер, є простим. 
Якщо ви використовуєте python, веб-сервер включений у ваш виклик :code:`from XRPLib.defaults import*`. Якщо ви використовуєте blockly, це також буде зроблено за вас.

Наш веб-сервер підтримує низку корисних інструментів для ведення журналів та налагодження, якими ви можете скористатися. 
Сюди входить додавання кнопок для виклику функцій, які ви пишете безпосередньо з веб-сервера, що дозволяє дистанційно керувати вашим роботом, або ведення журналів змінних на веб-сервері під час виконання вашої програми, що дозволяє бачити зміни значень у реальному часі.

Наразі ми зосередимося на основах використання веб-сервера та його запуску, 
а в наступному розділі розглянемо, як використовувати всі його функції.

Запуск веб-сервера:
-----------------------

Веб-сервер може працювати у двох основних режимах. Перший називається «режим моста», а другий — «режим точки доступу».
У режимі моста XRP підключається до вашої домашньої мережі Wi-Fi і використовує її для зв'язку з вашим комп'ютером або мобільним пристроєм.
У режимі точки доступу XRP створює власну мережу Wi-Fi, до якої ви можете підключитися за допомогою комп'ютера або мобільного пристрою.

.. note::
    XRP може підключатися тільки до мереж Wi-Fi 2,4 ГГц. Якщо ви використовуєте мережу 5 ГГц, вам         потрібно буде переключитися на мережу 2,4 ГГц.

Щоб запустити веб-сервер у режимі моста, вам потрібно знати ім'я та пароль вашої домашньої мережі Wi-Fi.
У кореневому каталозі вашого робота ви знайдете файл під назвою :code:`secrets.json`.
Тут ви можете безпечно зберігати ім'я та пароль вашої мережі Wi-Fi, які будуть використовуватися веб-сервером. Приклад цього файлу можна побачити тут:

.. code-block:: json

    {
        "wifi_ssid": "YOUR_WIFI_SSID",
        "wifi_password": "YOUR_WIFI_PASSWORD",
        "robot_id": 1,
        "ap_ssid": "XRP {robot_id}",
        "ap_password": "remote.xrp"
    }

У цьому файлі ви створите поля під назвою :code:`wifi_ssid` та :code:`wifi_password`. 
Якщо ви використовуєте режим моста, саме тут ви вкажете назву вашої мережі Wi-Fi та пароль.
Якщо ви використовуєте режим точки доступу, вам потрібно буде використовувати поля :code:`ap_ssid` та :code:`ap_password`.
Поле :code:`robot_id` можна використовувати для присвоєння вашому роботу унікального імені, коли він працює в режимі точки доступу, і воно замінить :code:`"{robot_id}"` у полі :code:`ap_ssid`.
Використання цього файлу json не є обов'язковим, і ці поля можна вказати пізніше в python або blockly.

Запуск веб-сервера в режимі точки доступу дуже простий. 
Все, що потрібно зробити, це викликати функцію :code:`start_network`, а потім функцію :code:`start_server`.
Якщо ви не налаштували файл :code:`secrets.json`, вам потрібно буде вказати ім'я точки доступу та пароль у функції :code:`start_network`.
В іншому випадку ви можете залишити ці поля порожніми, і веб-сервер буде використовувати значення з файлу :code:`secrets.json`.

У режимі моста все майже так само, за винятком того, що замість функції :code:`start_network` ви будете викликати функцію :code:`connect_to_network`.
Аналогічно, якщо ви не налаштували файл :code:`secrets.json`, вам потрібно буде вказати тут ім'я мережі та пароль.

.. tab-set::

    .. tab-item:: Python

        .. code-block:: python

            webserver.start_network(ssid="XRP_{robot_id}", robot_id=15, password="remote.xrp")    
            webserver.start_server()

        OR

        .. code-block:: python

            webserver.connect_to_network(ssid="YOUR_NETWORK", password="YOUR_PASSWORD")
            webserver.start_server()

    .. tab-item:: Blockly

        .. image:: media/start-server.png
            :width: 600

        OR

        .. image:: media/connect-to-network.png
            :width: 700


Якщо ви використовуєте режим точки доступу, знайдіть мережі Wi-Fi на своєму телефоні або комп'ютері та підключіться до мережі Wi-Fi, вказавши назва та пароль, які ви вибрали.

Нарешті, відкрийте нову сторінку у своєму браузері. У режимі моста вам доведеться перейти до IP-адреси, вказаної під час запуску веб-сервера (виділено нижче).
Ви повинні побачити свою нову налаштовану панель інструментів! Наразі вона буде виглядати досить порожньою, але пізніше ми додамо до неї більше елементів.

.. image:: media/ip-address.png
    :width: 600

.. note:: 
    Після запуску сервера програма XRP бере на себе контроль над виконанням програм і не повертається,     поки веб-сервер не буде зупинений.
    Переконайтеся, що все, що ви хочете зробити, виконано до запуску веб-сервера. Це може змінитися в     майбутньому оновленні.

Тепер ви знаєте, як запустити веб-сервер. Далі ви дізнаєтеся, як використовувати всі його функції.. 
