Вступ до пропорційного регулювання
====================================

Що таке пропорційне регулювання?
-----------------------------

Уявіть, що ви керуєте автомобілем і хочете підтримувати постійну швидкість. Якщо ви їдете занадто повільно,
ви трохи натискаєте на педаль газу, а якщо їдете занадто швидко, ви її відпускаєте. Але замість того, щоб
просто натиснути або відпустити педаль газу повністю (як вимикач), ви регулюєте
силу натискання залежно від того, наскільки ви відхиляєтеся від бажаної швидкості. Це основна ідея
пропорційного регулювання. Чим далі ви відхиляєтеся від мети, тим сильніше ви намагаєтеся це виправити.
Якщо ви відхиляєтеся несильно, ви робите невелике коригування. Якщо ви відхиляєтеся сильно, ви робите велике коригування.

Давайте продовжимо цю аналогію — ви вирішили, що ідеальна швидкість руху для вашої поїздки на автомобілі становить 70 миль на годину.
Ця швидкість відображає ваше бажане значення або те, чого ви прагнете досягти в ідеалі. У теорії управління це називається **заданим значенням**.

Ви виїжджаєте на шосе і, влаштовуючись за кермом, поглядаєте на спідометр. Він показує 65 миль на годину, що є вашим поточним значенням. У теорії управління це називається **змінною процесу**.

Звичайно, ви розумієте, що існує різниця між тим, де ви хочете бути (70 миль/год), і тим, де ви знаходитесь зараз (65 миль/год). Ця різниця називається **похибкою**, і в даному випадку вона становить 5 миль/год. Її легко обчислити за формулою:

.. tab-set::

    .. tab-item:: Python

        .. code-block:: python

            error = setpoint - process_variable
    
    .. tab-item:: Blockly

        .. image:: media/set_error.png
            :width: 300

Знати про помилку недостатньо. Як ви, водій, повинні на неї реагувати? Тут на допомогу приходить концепція пропорційного керування.

Уявіть собі регулювання P як ваш інстинкт водія. Замість того, щоб різко натискати на педаль газу або гальмувати, ви регулюєте швидкість, виходячи з помилки: наскільки ви відхилилися від бажаної швидкості.

Показник, який називається **контрольний вихід**, вказує, наскільки потрібно скоригувати. Він розраховується як:

.. tab-set::

    .. tab-item:: Python

        .. code-block:: python

            control_output = Kp * error

    .. tab-item:: Blockly

        .. image:: media/control_output.png
            :width: 300

де Kp — це константа, яка називається **пропорційним коефіцієнтом підсилення** і діє як коефіцієнт масштабування для похибки.

Якщо Kp велике, це як ніби у вас важка нога і ви сильно прискорюєтеся навіть при невеликій помилці. Ви дістанетеся швидше, але менш точно і з більшою ймовірністю проїдете.

З іншого боку, якщо Kp низький, ви більш обережний водій, який м'яко натискає на педаль газу, щоб уникнути помилки. Ви доїдете до місця призначення повільніше, але набагато плавніше.

Наявність постійного Kp дозволяє налаштувати систему управління на свій смак.

Зверніть увагу, що ця аналогія дещо не відповідає дійсності. Уявіть, що ваша поточна швидкість *більша* за бажану швидкість. У цьому випадку похибка є від'ємною. Якщо ви підставите це в формулу вихідного сигналу регулятора, ви отримаєте від'ємний вихідний сигнал регулятора. Це означає, що пропорційний регулятор фактично сповільнить вас, якщо ви їдете занадто швидко, пропорційно до того, наскільки ви відхиляєтеся від бажаної швидкості. Отже, ви можете уявити, що пропорційний регулятор — це як водій, який завжди намагається дотримуватися обмеження швидкості, використовуючи як акселератор, так і гальма.

Налаштування Kp
---------

Наступний графік показує пропорційне регулювання в дії.

.. image:: media/proportional.jpeg
    :width: 400

Синя лінія є еталонною і вказує на бажане значення. Червона, зелена та фіолетова лінії відображають поточне значення в часі при регулюванні пропорційним контролером з різними значеннями Kp.

При низькому Kp червона лінія повільно реагує на помилку, а контролер працює мляво. Досягнення бажаного значення займає багато часу, і воно ніколи не досягається повністю. Це називається **недостатньо затухаючим** поведінкою.

При високому значенні Kp фіолетова лінія швидко реагує на помилку, а контролер діє агресивно. Він швидко досягає бажаного значення, але перевищує його, що призводить до того, що помилка стає від'ємною. Потім він коригує себе, але знову перевищує значення і так далі. Це називається **надлишковим загасанням** і призводить до коливань навколо бажаного значення.

Зелена лінія є оптимальною. Вона швидко досягає бажаного значення і не перевищує його значно. Важливим завданням є налаштування Kp таким чином, щоб регулятор наближався до бажаного значення якомога швидше і плавніше.

Примітка: Ви побачите, що навіть при відмінному налаштуванні пропорційний контролер часто або трохи коливається, або ніколи не досягає бажаного значення. Більш просунуті системи управління, такі як PID, спрямовані на мінімізацію цих проблем, але вони виходять за рамки цього курсу.






